@using Microsoft.AspNetCore.Identity
@using DesapegAutoWeb.Areas.Identity.Data
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@{
    var isSignedIn = SignInManager.IsSignedIn(User);
    var userName = UserManager.GetUserName(User) ?? "Usuário";
    var displayName = userName.Contains("@") ? userName.Split('@')[0] : userName;

    if (User.IsInRole("Admin"))
    {
        displayName = "Administrador";
    }

    var helpUrl = Url.Action("Privacy", "Home") ?? "#";
}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - DesapegAuto</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/DesapegAutoWeb.styles.css" asp-append-version="true" />
</head>
<body class="da-body">
    @if (isSignedIn)
    {
        <header class="da-topbar">
            <div class="da-topbar-inner">
                <a class="da-topbar-greeting" asp-controller="Home" asp-action="Index">Olá, @displayName</a>
                <div class="da-topbar-actions">
                    <a class="da-icon-link" asp-controller="Perfil" asp-action="Index" title="Perfil" aria-label="Perfil">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M12 12a4.75 4.75 0 1 0 0-9.5 4.75 4.75 0 0 0 0 9.5Zm0 2.5c-4.33 0-8 2.28-8 5v1h16v-1c0-2.72-3.67-5-8-5Z" />
                        </svg>
                    </a>
                    <a class="da-icon-link" href="@helpUrl" title="Ajuda" aria-label="Ajuda">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M12 2.25A9.75 9.75 0 1 0 21.75 12 9.76 9.76 0 0 0 12 2.25Zm0 16.1a1.1 1.1 0 1 1 0 2.2 1.1 1.1 0 0 1 0-2.2Zm1.78-6.55-.72.45a1.3 1.3 0 0 0-.63 1.1v.4h-1.86v-.53a2.77 2.77 0 0 1 1.35-2.37l.88-.56a1.55 1.55 0 0 0 .75-1.34 1.57 1.57 0 1 0-3.14 0H8.55a3.43 3.43 0 1 1 6.86 0 3.33 3.33 0 0 1-1.63 2.85Z" />
                        </svg>
                    </a>
                </div>
            </div>
        </header>
    }
    else
    {
        <header class="da-topbar">
            <div class="da-topbar-inner">
                <a class="da-topbar-greeting" asp-controller="Home" asp-action="Index">DesapegAuto</a>
                <div class="da-topbar-actions">
                    <a class="da-topbar-link" asp-area="Identity" asp-page="/Account/Login">Entrar</a>
                    <a class="da-topbar-link" asp-area="Identity" asp-page="/Account/Register">Criar conta</a>
                </div>
            </div>
        </header>
    }

    <main class="da-main">
        @RenderBody()
    </main>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
